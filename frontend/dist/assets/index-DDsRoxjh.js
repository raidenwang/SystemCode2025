import{_ as x,a as U,r as _,Q as C,c as u,o as m,m as e,L as f,am as y,A as b,a5 as l,aF as H,n as h,an as S,ac as M,p as D,aG as p,aO as w,t as q,v as A,aP as N}from"./index-BehJRYYk.js";const a=v=>(q("data-v-0da99bc9"),v=v(),A(),v),J={class:"textual-page"},O={class:"container"},T=a(()=>e("h2",{class:"page-title"},"症状确认",-1)),$={class:"info-card"},j=a(()=>e("h3",{class:"section-title"},"您选择的症状",-1)),B={class:"symptoms-display"},F={class:"symptom-name"},z={class:"duration-select-wrapper"},L=["onUpdate:modelValue"],P=["value"],Q=a(()=>e("i",{class:"icon-chevron-down"},null,-1)),R={key:1,class:"empty-state"},E=a(()=>e("i",{class:"icon-info"},null,-1)),G=a(()=>e("h3",{class:"section-title"},"患者信息",-1)),K={class:"form-grid"},W={class:"form-item"},Y=a(()=>e("label",{for:"name",class:"form-label"},"姓名",-1)),X={class:"form-item"},Z=a(()=>e("label",{for:"age",class:"form-label"},"年龄",-1)),ee={class:"form-item"},se=a(()=>e("label",{for:"weight",class:"form-label"},"体重",-1)),te={class:"form-item"},oe=a(()=>e("label",{class:"form-label"},"性别",-1)),ae={class:"radio-group"},le={class:"radio-item"},ie=a(()=>e("span",{class:"radio-label"},"男",-1)),ne={class:"radio-item"},de=a(()=>e("span",{class:"radio-label"},"女",-1)),ce={class:"form-item full-width"},re=a(()=>e("label",{for:"allergy",class:"form-label"},"过敏史",-1)),ue={class:"form-item full-width"},me=a(()=>e("label",{for:"medicalHistory",class:"form-label"},"过往病史",-1)),pe=a(()=>e("i",{class:"icon-add"},null,-1)),ve=a(()=>e("i",{class:"icon-check"},null,-1)),_e={__name:"index",setup(v){const I=U(),c=_(!0);_(localStorage.getItem("savedSymptoms")||"");const o=_({name:"",age:"",weight:"",gender:null,allergy:"",medicalHistory:"",...JSON.parse(localStorage.getItem("patientInfo")||"{}")}),r=_([]);C(()=>{const i=localStorage.getItem("savedSymptoms");if(i){const t=i.split(" ").filter(s=>s.trim());r.value=t.map(s=>({name:s,duration:1}))}});const k=()=>{c.value=!c.value},V=()=>{const i=r.value.map(t=>`${t.name}（${t.duration||"未填写"}天）`).join(" ");localStorage.setItem("savedSymptoms",i),window.location.href="http://localhost/guide/patientInfo/human"},g=async()=>{const i={...o.value,symptoms:r.value.map(n=>`${n.name}（${n.duration||"未填写"}天）`).join(" "),allergy:o.value.allergy||"未提及",medicalHistory:o.value.medicalHistory||"未提及"};localStorage.setItem("patientInfo",JSON.stringify(i));const t={model:"glm-4v-flash",messages:[{role:"system",content:"你是一个专业的医生,请根据我给出的患者信息，首先给出建议就诊科室（标题是建议就诊科室），然后生成患者的电子病历（标题名为电子病历），然后是给出初步诊断（标题初步诊断），最后是治疗建议（标题治疗建议）。"},{role:"user",content:JSON.stringify(i)}]},s={headers:{Authorization:"a7ab43a5f9194de788cd0711505136cb.u2ocKQpIY8MJ4nIf","Content-Type":"application/json"}};try{const d=(await N.post("https://open.bigmodel.cn/api/paas/v4/chat/completions",t,s)).data.choices[0].message.content;localStorage.setItem("diagnosisMessage",d),I.push({path:"/guide/result"})}catch(n){console.error("API请求失败",n)}};return(i,t)=>(m(),u("div",J,[e("div",O,[T,e("div",$,[j,e("div",B,[r.value.length>0?(m(!0),u(f,{key:0},y(r.value,(s,n)=>(m(),u("div",{key:n,class:"symptom-item"},[e("div",F,b(s.name),1),e("div",z,[l(e("select",{"onUpdate:modelValue":d=>s.duration=d,class:"duration-select"},[(m(),u(f,null,y(30,d=>e("option",{value:d,key:d},b(d)+"天",9,P)),64))],8,L),[[H,s.duration]]),Q])]))),128)):(m(),u("div",R,[E,h(" 尚未选择任何症状 ")]))])]),e("div",{class:S(["info-card collapsible",{"is-collapsed":c.value}])},[e("div",{class:"section-header",onClick:k},[G,e("i",{class:S(["icon-chevron",{"rotate-180":!c.value}])},null,2)]),l(e("form",{onSubmit:D(g,["prevent"]),class:"patient-form"},[e("div",K,[e("div",W,[Y,l(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=s=>o.value.name=s),placeholder:"请输入姓名",class:"form-input",required:""},null,512),[[p,o.value.name]])]),e("div",X,[Z,l(e("input",{id:"age","onUpdate:modelValue":t[1]||(t[1]=s=>o.value.age=s),type:"number",placeholder:"请输入年龄",class:"form-input",required:""},null,512),[[p,o.value.age]])]),e("div",ee,[se,l(e("input",{id:"weight","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.weight=s),type:"number",placeholder:"请输入体重（kg）",class:"form-input",required:""},null,512),[[p,o.value.weight]])]),e("div",te,[oe,e("div",ae,[e("label",le,[l(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.gender=s),value:1,required:""},null,512),[[w,o.value.gender]]),ie]),e("label",ne,[l(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=s=>o.value.gender=s),value:0,required:""},null,512),[[w,o.value.gender]]),de])])]),e("div",ce,[re,l(e("input",{id:"allergy","onUpdate:modelValue":t[5]||(t[5]=s=>o.value.allergy=s),placeholder:"请输入过敏史（如无则留空）",class:"form-input"},null,512),[[p,o.value.allergy]])]),e("div",ue,[me,l(e("input",{id:"medicalHistory","onUpdate:modelValue":t[6]||(t[6]=s=>o.value.medicalHistory=s),placeholder:"请输入过往病史（如无则留空）",class:"form-input"},null,512),[[p,o.value.medicalHistory]])])])],544),[[M,!c.value]])],2),e("div",{class:"action-buttons-container"},[e("button",{type:"button",class:"btn secondary",onClick:V},[pe,h(" 继续添加症状 ")]),e("button",{type:"submit",class:"btn primary",onClick:g},[ve,h(" 确认提交 ")])])])]))}},ge=x(_e,[["__scopeId","data-v-0da99bc9"]]);export{ge as default};
