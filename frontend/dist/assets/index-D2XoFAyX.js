import{au as c,O as fe,d as ce,r as v,P as _e,ag as he,e as u,a6 as Q,c as q,o as i,a5 as N,f as e,j as P,ac as ge,k as a,h as t,l as ve,L as j,am as K,i as y,n as f,af as z,m as G,A as H,a9 as ye}from"./index-BehJRYYk.js";function J(d){return c({url:"/system/dept/list",method:"get",params:d})}function be(d){return c({url:"/system/dept/list/exclude/"+d,method:"get"})}function Ve(d){return c({url:"/system/dept/"+d,method:"get"})}function Ne(d){return c({url:"/system/dept",method:"post",data:d})}function ke(d){return c({url:"/system/dept",method:"put",data:d})}function Ie(d){return c({url:"/system/dept/"+d,method:"delete"})}function De(d){return c({url:"/hospital/addDepartment",method:"post",data:d})}function we(d){return c({url:"/hospital/updateCategoryOrDepartment",method:"post",data:d})}function Ce(d){return c({url:"/hospital/getDeptName?deptId="+d,method:"post"})}function xe(d){return c({url:"/hospital/deleteDepartment?name="+d,method:"post"})}const Ue={class:"app-container"},Se={class:"dialog-footer"},Te=fe({name:"Dept"}),Re=Object.assign(Te,{setup(d){const{proxy:p}=ce(),{sys_normal_disable:w}=p.useDict("sys_normal_disable"),E=v([]),g=v(!1),C=v(!0),I=v(!0),x=v(""),U=v([]),S=v(!0),T=v(!0),M=_e({form:{},queryParams:{deptName:void 0,status:void 0},rules:{parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],info:[{message:"请输入部门信息"}]}}),{queryParams:b,form:o,rules:W}=he(M);function V(){C.value=!0,J(b.value).then(r=>{E.value=p.handleTree(r.data,"deptId"),C.value=!1})}function X(){g.value=!1,$()}function $(){o.value={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0",info:void 0},p.resetForm("deptRef")}function R(){V()}function Y(){p.resetForm("queryRef"),R()}function O(r){$(),J().then(n=>{U.value=p.handleTree(n.data,"deptId")}),r!=null&&(o.value.parentId=r.deptId),g.value=!0,x.value="添加部门"}function Z(){T.value=!1,S.value=!S.value,ye(()=>{T.value=!0})}function ee(r){$(),be(r.deptId).then(n=>{U.value=p.handleTree(n.data,"deptId")}),Ve(r.deptId).then(n=>{o.value=n.data,g.value=!0,x.value="修改部门"})}function te(){p.$refs.deptRef.validate(async r=>{if(r)if(o.value.deptId!=null){console.log("info",o.value.info);const _=(await Ce(o.value.deptId)).msg;ke(o.value).then(A=>{p.$modal.msgSuccess("修改成功"),g.value=!1,V()});const s={parentId:o.value.parentId,name:o.value.deptName,oldName:_,info:o.value.info};we(s)}else{Ne(o.value).then(_=>{p.$modal.msgSuccess("新增成功"),g.value=!1,V()});const n={parentId:o.value.parentId,deptName:o.value.deptName,info:o.value.info};De(n)}})}function le(r){p.$modal.confirm('是否确认删除名称为"'+r.deptName+'"的数据项?').then(function(){return xe(r.deptName),Ie(r.deptId)}).then(()=>{V(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}return V(),(r,n)=>{const _=u("el-input"),s=u("el-form-item"),A=u("el-option"),ae=u("el-select"),h=u("el-button"),B=u("el-form"),m=u("el-col"),ne=u("right-toolbar"),F=u("el-row"),k=u("el-table-column"),oe=u("dict-tag"),de=u("el-table"),ue=u("el-tree-select"),re=u("el-input-number"),se=u("el-radio"),pe=u("el-radio-group"),ie=u("el-dialog"),D=Q("hasPermi"),me=Q("loading");return i(),q("div",Ue,[N(e(B,{model:a(b),ref:"queryRef",inline:!0},{default:t(()=>[e(s,{label:"部门名称",prop:"deptName"},{default:t(()=>[e(_,{modelValue:a(b).deptName,"onUpdate:modelValue":n[0]||(n[0]=l=>a(b).deptName=l),placeholder:"请输入部门名称",clearable:"",style:{width:"200px"},onKeyup:ve(R,["enter"])},null,8,["modelValue"])]),_:1}),e(s,{label:"状态",prop:"status"},{default:t(()=>[e(ae,{modelValue:a(b).status,"onUpdate:modelValue":n[1]||(n[1]=l=>a(b).status=l),placeholder:"部门状态",clearable:"",style:{width:"200px"}},{default:t(()=>[(i(!0),q(j,null,K(a(w),l=>(i(),y(A,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:t(()=>[e(h,{type:"primary",icon:"Search",onClick:R},{default:t(()=>[f("搜索")]),_:1}),e(h,{icon:"Refresh",onClick:Y},{default:t(()=>[f("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[ge,a(I)]]),e(F,{gutter:10,class:"mb8"},{default:t(()=>[e(m,{span:1.5},{default:t(()=>[N((i(),y(h,{type:"primary",plain:"",icon:"Plus",onClick:O},{default:t(()=>[f("新增")]),_:1})),[[D,["system:dept:add"]]])]),_:1}),e(m,{span:1.5},{default:t(()=>[e(h,{type:"info",plain:"",icon:"Sort",onClick:Z},{default:t(()=>[f("展开/折叠")]),_:1})]),_:1}),e(ne,{showSearch:a(I),"onUpdate:showSearch":n[2]||(n[2]=l=>z(I)?I.value=l:null),onQueryTable:V},null,8,["showSearch"])]),_:1}),a(T)?N((i(),y(de,{key:0,data:a(E),"row-key":"deptId","default-expand-all":a(S),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:t(()=>[e(k,{prop:"deptName",label:"部门名称",width:"260"}),e(k,{prop:"orderNum",label:"排序",width:"200"}),e(k,{prop:"status",label:"状态",width:"100"},{default:t(l=>[e(oe,{options:a(w),value:l.row.status},null,8,["options","value"])]),_:1}),e(k,{label:"创建时间",align:"center",prop:"createTime",width:"200"},{default:t(l=>[G("span",null,H(r.parseTime(l.row.createTime)),1)]),_:1}),e(k,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(l=>[N((i(),y(h,{link:"",type:"primary",icon:"Edit",onClick:L=>ee(l.row)},{default:t(()=>[f("修改")]),_:2},1032,["onClick"])),[[D,["system:dept:edit"]]]),N((i(),y(h,{link:"",type:"primary",icon:"Plus",onClick:L=>O(l.row)},{default:t(()=>[f("新增")]),_:2},1032,["onClick"])),[[D,["system:dept:add"]]]),l.row.parentId!=0?N((i(),y(h,{key:0,link:"",type:"primary",icon:"Delete",onClick:L=>le(l.row)},{default:t(()=>[f("删除")]),_:2},1032,["onClick"])),[[D,["system:dept:remove"]]]):P("",!0)]),_:1})]),_:1},8,["data","default-expand-all"])),[[me,a(C)]]):P("",!0),e(ie,{title:a(x),modelValue:a(g),"onUpdate:modelValue":n[11]||(n[11]=l=>z(g)?g.value=l:null),width:"600px","append-to-body":""},{footer:t(()=>[G("div",Se,[e(h,{type:"primary",onClick:te},{default:t(()=>[f("确 定")]),_:1}),e(h,{onClick:X},{default:t(()=>[f("取 消")]),_:1})])]),default:t(()=>[e(B,{ref:"deptRef",model:a(o),rules:a(W),"label-width":"80px"},{default:t(()=>[e(F,null,{default:t(()=>[a(o).parentId!==0?(i(),y(m,{key:0,span:24},{default:t(()=>[e(s,{label:"上级部门",prop:"parentId"},{default:t(()=>[e(ue,{modelValue:a(o).parentId,"onUpdate:modelValue":n[3]||(n[3]=l=>a(o).parentId=l),data:a(U),props:{value:"deptId",label:"deptName",children:"children"},"value-key":"deptId",placeholder:"选择上级部门","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})):P("",!0),e(m,{span:12},{default:t(()=>[e(s,{label:"部门名称",prop:"deptName"},{default:t(()=>[e(_,{modelValue:a(o).deptName,"onUpdate:modelValue":n[4]||(n[4]=l=>a(o).deptName=l),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"显示排序",prop:"orderNum"},{default:t(()=>[e(re,{modelValue:a(o).orderNum,"onUpdate:modelValue":n[5]||(n[5]=l=>a(o).orderNum=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"负责人",prop:"leader"},{default:t(()=>[e(_,{modelValue:a(o).leader,"onUpdate:modelValue":n[6]||(n[6]=l=>a(o).leader=l),placeholder:"请输入负责人",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"联系电话",prop:"phone"},{default:t(()=>[e(_,{modelValue:a(o).phone,"onUpdate:modelValue":n[7]||(n[7]=l=>a(o).phone=l),placeholder:"请输入联系电话",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"邮箱",prop:"email"},{default:t(()=>[e(_,{modelValue:a(o).email,"onUpdate:modelValue":n[8]||(n[8]=l=>a(o).email=l),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"部门状态"},{default:t(()=>[e(pe,{modelValue:a(o).status,"onUpdate:modelValue":n[9]||(n[9]=l=>a(o).status=l)},{default:t(()=>[(i(!0),q(j,null,K(a(w),l=>(i(),y(se,{key:l.value,label:l.value},{default:t(()=>[f(H(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:t(()=>[e(s,{label:"部门信息",prop:"category"},{default:t(()=>[e(_,{modelValue:a(o).info,"onUpdate:modelValue":n[10]||(n[10]=l=>a(o).info=l),placeholder:"请输入部门信息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Re as default};
